!function(e){var i=!1,t={data:[],placeholder:"",secondaryPlaceholder:""};e(document).ready(function(){e(document).on("click",".chip .close",function(i){var t=e(this).closest(".chips");t.attr("data-initialized")||e(this).closest(".chip").remove()})}),e.fn.material_chip=function(s){var a=this;if(this.$el=e(this),this.$document=e(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===s)return this.$el.data("chips");var c=e.extend({},t,s);this.init=function(){var i=0;a.$el.each(function(){var t=e(this),s=Materialize.guid();c.data&&c.data instanceof Array||(c.data=[]),t.data("chips",c.data),t.attr("data-index",i),t.attr("data-initialized",!0),t.hasClass(a.SELS.CHIPS)||t.addClass("chips"),a.chips(t,s),i++})},this.handleEvents=function(){var i=a.SELS;a.$document.off("click.chips-focus",i.CHIPS).on("click.chips-focus",i.CHIPS,function(t){e(t.target).find(i.INPUT).focus()}),a.$document.off("click.chips-select",i.CHIP).on("click.chips-select",i.CHIP,function(t){e(i.CHIP).removeClass("selected"),e(this).toggleClass("selected")}),a.$document.off("keydown.chips").on("keydown.chips",function(t){if(!e(t.target).is("input, textarea")){var s,c=a.$document.find(i.CHIP+i.SELECTED_CHIP),n=c.closest(i.CHIPS),l=c.siblings(i.CHIP).length;if(c.length)if(8===t.which||46===t.which){t.preventDefault(),s=c.index(),a.deleteChip(s,n);var d=null;s+1<l?d=s:s!==l&&s+1!==l||(d=l-1),d<0&&(d=null),null!==d&&a.selectChip(d,n),l||n.find("input").focus()}else if(37===t.which){if(s=c.index()-1,s<0)return;e(i.CHIP).removeClass("selected"),a.selectChip(s,n)}else if(39===t.which){if(s=c.index()+1,e(i.CHIP).removeClass("selected"),s>l)return void n.find("input").focus();a.selectChip(s,n)}}}),a.$document.off("focusin.chips",i.CHIPS+" "+i.INPUT).on("focusin.chips",i.CHIPS+" "+i.INPUT,function(t){var s=e(t.target).closest(i.CHIPS);s.addClass("focus"),s.siblings("label, .prefix").addClass("active"),e(i.CHIP).removeClass("selected")}),a.$document.off("focusout.chips",i.CHIPS+" "+i.INPUT).on("focusout.chips",i.CHIPS+" "+i.INPUT,function(t){var s=e(t.target).closest(i.CHIPS);s.removeClass("focus"),s.data("chips").length||s.siblings("label").removeClass("active"),s.siblings(".prefix").removeClass("active")}),a.$document.off("keydown.chips-add",i.CHIPS+" "+i.INPUT).on("keydown.chips-add",i.CHIPS+" "+i.INPUT,function(t){var s=e(t.target),c=s.closest(i.CHIPS),n=c.children(i.CHIP).length;return 13===t.which?(t.preventDefault(),a.addChip({tag:s.val()},c),void s.val("")):8!==t.keyCode&&37!==t.keyCode||""!==s.val()||!n?void 0:(a.selectChip(n-1,c),void s.blur())}),a.$document.off("click.chips-delete",i.CHIPS+" "+i.DELETE).on("click.chips-delete",i.CHIPS+" "+i.DELETE,function(t){var s=e(t.target),c=s.closest(i.CHIPS),n=s.closest(i.CHIP);t.stopPropagation(),a.deleteChip(n.index(),c),c.find("input").focus()})},this.chips=function(e,i){var t="";e.data("chips").forEach(function(e){t+=a.renderChip(e)}),t+='<input id="'+i+'" class="input" placeholder="">',e.html(t),a.setPlaceholder(e);var s=e.next("label");s.length&&(s.attr("for",i),e.data("chips").length&&s.addClass("active"))},this.renderChip=function(e){if(e.tag){var i='<div class="chip">'+e.tag;return e.image&&(i+=' <img src="'+e.image+'"> '),i+='<i class="material-icons close">close</i>',i+="</div>"}},this.setPlaceholder=function(e){e.data("chips").length&&c.placeholder?e.find("input").prop("placeholder",c.placeholder):!e.data("chips").length&&c.secondaryPlaceholder&&e.find("input").prop("placeholder",c.secondaryPlaceholder)},this.isValid=function(e,i){for(var t=e.data("chips"),s=!1,a=0;a<t.length;a++)if(t[a].tag===i.tag)return void(s=!0);return""!==i.tag&&!s},this.addChip=function(i,t){if(a.isValid(t,i)){for(var s=a.renderChip(i),c=[],n=t.data("chips"),l=0;l<n.length;l++)c.push(n[l]);c.push(i),t.data("chips",c),e(s).insertBefore(t.find("input")),t.trigger("chip.add",i),a.setPlaceholder(t)}},this.deleteChip=function(e,i){var t=i.data("chips")[e];i.find(".chip").eq(e).remove();for(var s=[],c=i.data("chips"),n=0;n<c.length;n++)n!==e&&s.push(c[n]);i.data("chips",s),i.trigger("chip.delete",t),a.setPlaceholder(i)},this.selectChip=function(e,i){var t=i.find(".chip").eq(e);t&&!1===t.hasClass("selected")&&(t.addClass("selected"),i.trigger("chip.select",i.data("chips")[e]))},this.getChipsElement=function(e,i){return i.eq(e)},this.init(),i||(this.handleEvents(),i=!0)}}(jQuery);